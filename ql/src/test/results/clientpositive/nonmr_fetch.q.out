PREHOOK: query: -- limit
explain select key from src limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- limit
explain select key from src limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src
          Select Operator
            expressions:
                  expr: key
                  type: string
            outputColumnNames: _col0
            Limit


PREHOOK: query: select key from src limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key from src limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
238
86
311
27
165
409
255
278
98
484
PREHOOK: query: -- filter
explain select key from src where key < 100 limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- filter
explain select key from src where key < 100 limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key))) (TOK_WHERE (< (TOK_TABLE_OR_COL key) 100)) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src
          Filter Operator
            predicate:
                expr: (key < 100.0)
                type: boolean
            Select Operator
              expressions:
                    expr: key
                    type: string
              outputColumnNames: _col0
              Limit


PREHOOK: query: select key from src where key < 100 limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key from src where key < 100 limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
86
27
98
66
37
15
82
17
0
57
PREHOOK: query: -- partitioned
explain select key from srcpart where ds='2008-04-08' AND hr='11' limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- partitioned
explain select key from srcpart where ds='2008-04-08' AND hr='11' limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key))) (TOK_WHERE (AND (= (TOK_TABLE_OR_COL ds) '2008-04-08') (= (TOK_TABLE_OR_COL hr) '11'))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: srcpart
          Select Operator
            expressions:
                  expr: key
                  type: string
            outputColumnNames: _col0
            Limit


PREHOOK: query: select key from srcpart where ds='2008-04-08' AND hr='11' limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
#### A masked pattern was here ####
POSTHOOK: query: select key from srcpart where ds='2008-04-08' AND hr='11' limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
#### A masked pattern was here ####
238
86
311
27
165
409
255
278
98
484
PREHOOK: query: -- virtual columns
explain select *, BLOCK__OFFSET__INSIDE__FILE from src where key < 10 limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- virtual columns
explain select *, BLOCK__OFFSET__INSIDE__FILE from src where key < 10 limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF) (TOK_SELEXPR (TOK_TABLE_OR_COL BLOCK__OFFSET__INSIDE__FILE))) (TOK_WHERE (< (TOK_TABLE_OR_COL key) 10)) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src
          Filter Operator
            predicate:
                expr: (key < 10.0)
                type: boolean
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
                    expr: BLOCK__OFFSET__INSIDE__FILE
                    type: bigint
              outputColumnNames: _col0, _col1, _col2
              Limit


PREHOOK: query: select *, BLOCK__OFFSET__INSIDE__FILE from src where key < 100 limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select *, BLOCK__OFFSET__INSIDE__FILE from src where key < 100 limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
86	val_86	12
27	val_27	34
98	val_98	92
66	val_66	198
37	val_37	328
15	val_15	386
82	val_82	396
17	val_17	910
0	val_0	968
57	val_57	1024
PREHOOK: query: -- virtual columns on partitioned
explain select *, BLOCK__OFFSET__INSIDE__FILE from srcpart where key < 10 limit 30
PREHOOK: type: QUERY
POSTHOOK: query: -- virtual columns on partitioned
explain select *, BLOCK__OFFSET__INSIDE__FILE from srcpart where key < 10 limit 30
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF) (TOK_SELEXPR (TOK_TABLE_OR_COL BLOCK__OFFSET__INSIDE__FILE))) (TOK_WHERE (< (TOK_TABLE_OR_COL key) 10)) (TOK_LIMIT 30)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 30
      Processor Tree:
        TableScan
          alias: srcpart
          Filter Operator
            predicate:
                expr: (key < 10.0)
                type: boolean
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
                    expr: ds
                    type: string
                    expr: hr
                    type: string
                    expr: BLOCK__OFFSET__INSIDE__FILE
                    type: bigint
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Limit


PREHOOK: query: select *, BLOCK__OFFSET__INSIDE__FILE from srcpart where key < 10 limit 30
PREHOOK: type: QUERY
#### A masked pattern was here ####
POSTHOOK: query: select *, BLOCK__OFFSET__INSIDE__FILE from srcpart where key < 10 limit 30
POSTHOOK: type: QUERY
#### A masked pattern was here ####
0	val_0	2008-04-08	11	968
4	val_4	2008-04-08	11	1218
8	val_8	2008-04-08	11	1916
0	val_0	2008-04-08	11	2088
0	val_0	2008-04-08	11	2632
5	val_5	2008-04-08	11	3060
5	val_5	2008-04-08	11	3864
2	val_2	2008-04-08	11	4004
5	val_5	2008-04-08	11	4540
9	val_9	2008-04-08	11	5398
0	val_0	2008-04-08	12	968
4	val_4	2008-04-08	12	1218
8	val_8	2008-04-08	12	1916
0	val_0	2008-04-08	12	2088
0	val_0	2008-04-08	12	2632
5	val_5	2008-04-08	12	3060
5	val_5	2008-04-08	12	3864
2	val_2	2008-04-08	12	4004
5	val_5	2008-04-08	12	4540
9	val_9	2008-04-08	12	5398
0	val_0	2008-04-09	11	968
4	val_4	2008-04-09	11	1218
8	val_8	2008-04-09	11	1916
0	val_0	2008-04-09	11	2088
0	val_0	2008-04-09	11	2632
5	val_5	2008-04-09	11	3060
5	val_5	2008-04-09	11	3864
2	val_2	2008-04-09	11	4004
5	val_5	2008-04-09	11	4540
9	val_9	2008-04-09	11	5398
