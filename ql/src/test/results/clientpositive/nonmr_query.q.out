PREHOOK: query: -- backward
explain select * from src limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- backward
explain select * from src limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10


PREHOOK: query: select * from src limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select * from src limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
238	val_238
86	val_86
311	val_311
27	val_27
165	val_165
409	val_409
255	val_255
278	val_278
98	val_98
484	val_484
PREHOOK: query: explain select * from srcpart where ds='2008-04-08' AND hr='11' limit 10
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from srcpart where ds='2008-04-08' AND hr='11' limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (AND (= (TOK_TABLE_OR_COL ds) '2008-04-08') (= (TOK_TABLE_OR_COL hr) '11'))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10


PREHOOK: query: select * from srcpart where ds='2008-04-08' AND hr='11' limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
#### A masked pattern was here ####
POSTHOOK: query: select * from srcpart where ds='2008-04-08' AND hr='11' limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
#### A masked pattern was here ####
238	val_238	2008-04-08	11
86	val_86	2008-04-08	11
311	val_311	2008-04-08	11
27	val_27	2008-04-08	11
165	val_165	2008-04-08	11
409	val_409	2008-04-08	11
255	val_255	2008-04-08	11
278	val_278	2008-04-08	11
98	val_98	2008-04-08	11
484	val_484	2008-04-08	11
PREHOOK: query: -- limit
explain select key from src limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- limit
explain select key from src limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src
          Select Operator
            expressions:
                  expr: key
                  type: string
            outputColumnNames: _col0
            Limit


PREHOOK: query: select key from src limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key from src limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
238
86
311
27
165
409
255
278
98
484
PREHOOK: query: -- filter
explain select key from src where key < 100 limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- filter
explain select key from src where key < 100 limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key))) (TOK_WHERE (< (TOK_TABLE_OR_COL key) 100)) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src
          Filter Operator
            predicate:
                expr: (key < 100.0)
                type: boolean
            Select Operator
              expressions:
                    expr: key
                    type: string
              outputColumnNames: _col0
              Limit


PREHOOK: query: select key from src where key < 100 limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key from src where key < 100 limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
86
27
98
66
37
15
82
17
0
57
PREHOOK: query: -- partitioned
explain select key from srcpart where ds='2008-04-08' AND hr='11' limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- partitioned
explain select key from srcpart where ds='2008-04-08' AND hr='11' limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key))) (TOK_WHERE (AND (= (TOK_TABLE_OR_COL ds) '2008-04-08') (= (TOK_TABLE_OR_COL hr) '11'))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: srcpart
          Select Operator
            expressions:
                  expr: key
                  type: string
            outputColumnNames: _col0
            Limit


PREHOOK: query: select key from srcpart where ds='2008-04-08' AND hr='11' limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
#### A masked pattern was here ####
POSTHOOK: query: select key from srcpart where ds='2008-04-08' AND hr='11' limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
#### A masked pattern was here ####
238
86
311
27
165
409
255
278
98
484
PREHOOK: query: -- virtual columns
explain select *, BLOCK__OFFSET__INSIDE__FILE from src where key < 10 limit 10
PREHOOK: type: QUERY
POSTHOOK: query: -- virtual columns
explain select *, BLOCK__OFFSET__INSIDE__FILE from src where key < 10 limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF) (TOK_SELEXPR (TOK_TABLE_OR_COL BLOCK__OFFSET__INSIDE__FILE))) (TOK_WHERE (< (TOK_TABLE_OR_COL key) 10)) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src
          Filter Operator
            predicate:
                expr: (key < 10.0)
                type: boolean
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
                    expr: BLOCK__OFFSET__INSIDE__FILE
                    type: bigint
              outputColumnNames: _col0, _col1, _col2
              Limit


PREHOOK: query: select *, BLOCK__OFFSET__INSIDE__FILE from src where key < 100 limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select *, BLOCK__OFFSET__INSIDE__FILE from src where key < 100 limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
86	val_86	12
27	val_27	34
98	val_98	92
66	val_66	198
37	val_37	328
15	val_15	386
82	val_82	396
17	val_17	910
0	val_0	968
57	val_57	1024
PREHOOK: query: -- virtual columns on partitioned
explain select *, BLOCK__OFFSET__INSIDE__FILE from srcpart where key < 10 limit 30
PREHOOK: type: QUERY
POSTHOOK: query: -- virtual columns on partitioned
explain select *, BLOCK__OFFSET__INSIDE__FILE from srcpart where key < 10 limit 30
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF) (TOK_SELEXPR (TOK_TABLE_OR_COL BLOCK__OFFSET__INSIDE__FILE))) (TOK_WHERE (< (TOK_TABLE_OR_COL key) 10)) (TOK_LIMIT 30)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 30
      Processor Tree:
        TableScan
          alias: srcpart
          Filter Operator
            predicate:
                expr: (key < 10.0)
                type: boolean
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
                    expr: ds
                    type: string
                    expr: hr
                    type: string
                    expr: BLOCK__OFFSET__INSIDE__FILE
                    type: bigint
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Limit


PREHOOK: query: select *, BLOCK__OFFSET__INSIDE__FILE from srcpart where key < 10 limit 30
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
POSTHOOK: query: select *, BLOCK__OFFSET__INSIDE__FILE from srcpart where key < 10 limit 30
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
0	val_0	2008-04-08	11	968
4	val_4	2008-04-08	11	1218
8	val_8	2008-04-08	11	1916
0	val_0	2008-04-08	11	2088
0	val_0	2008-04-08	11	2632
5	val_5	2008-04-08	11	3060
5	val_5	2008-04-08	11	3864
2	val_2	2008-04-08	11	4004
5	val_5	2008-04-08	11	4540
9	val_9	2008-04-08	11	5398
0	val_0	2008-04-08	12	968
4	val_4	2008-04-08	12	1218
8	val_8	2008-04-08	12	1916
0	val_0	2008-04-08	12	2088
0	val_0	2008-04-08	12	2632
5	val_5	2008-04-08	12	3060
5	val_5	2008-04-08	12	3864
2	val_2	2008-04-08	12	4004
5	val_5	2008-04-08	12	4540
9	val_9	2008-04-08	12	5398
0	val_0	2008-04-09	11	968
4	val_4	2008-04-09	11	1218
8	val_8	2008-04-09	11	1916
0	val_0	2008-04-09	11	2088
0	val_0	2008-04-09	11	2632
5	val_5	2008-04-09	11	3060
5	val_5	2008-04-09	11	3864
2	val_2	2008-04-09	11	4004
5	val_5	2008-04-09	11	4540
9	val_9	2008-04-09	11	5398
PREHOOK: query: -- bucket sampling
explain select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart TABLESAMPLE (BUCKET 1 OUT OF 40 ON key)
PREHOOK: type: QUERY
POSTHOOK: query: -- bucket sampling
explain select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart TABLESAMPLE (BUCKET 1 OUT OF 40 ON key)
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart) (TOK_TABLEBUCKETSAMPLE 1 40 (TOK_TABLE_OR_COL key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key)) (TOK_SELEXPR (TOK_TABLE_OR_COL value)) (TOK_SELEXPR (TOK_TABLE_OR_COL BLOCK__OFFSET__INSIDE__FILE)))))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: srcpart
          Filter Operator
            predicate:
                expr: (((hash(key) & 2147483647) % 40) = 0)
                type: boolean
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
                    expr: BLOCK__OFFSET__INSIDE__FILE
                    type: bigint
              outputColumnNames: _col0, _col1, _col2


PREHOOK: query: select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart TABLESAMPLE (BUCKET 1 OUT OF 40 ON key)
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
POSTHOOK: query: select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart TABLESAMPLE (BUCKET 1 OUT OF 40 ON key)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
484	val_484	102
286	val_286	1404
187	val_187	1416
187	val_187	2492
77	val_77	2622
187	val_187	4516
448	val_448	5636
484	val_484	102
286	val_286	1404
187	val_187	1416
187	val_187	2492
77	val_77	2622
187	val_187	4516
448	val_448	5636
484	val_484	102
286	val_286	1404
187	val_187	1416
187	val_187	2492
77	val_77	2622
187	val_187	4516
448	val_448	5636
484	val_484	102
286	val_286	1404
187	val_187	1416
187	val_187	2492
77	val_77	2622
187	val_187	4516
448	val_448	5636
PREHOOK: query: -- split sampling
explain select * from srcpart TABLESAMPLE (0.25 PERCENT)
PREHOOK: type: QUERY
POSTHOOK: query: -- split sampling
explain select * from srcpart TABLESAMPLE (0.25 PERCENT)
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart) (TOK_TABLESPLITSAMPLE 0.25))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF))))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: select * from srcpart TABLESAMPLE (0.25 PERCENT)
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
POSTHOOK: query: select * from srcpart TABLESAMPLE (0.25 PERCENT)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
238	val_238	2008-04-08	11
86	val_86	2008-04-08	11
238	val_238	2008-04-08	12
86	val_86	2008-04-08	12
238	val_238	2008-04-09	11
86	val_86	2008-04-09	11
238	val_238	2008-04-09	12
86	val_86	2008-04-09	12
PREHOOK: query: explain select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart TABLESAMPLE (0.25 PERCENT)
PREHOOK: type: QUERY
POSTHOOK: query: explain select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart TABLESAMPLE (0.25 PERCENT)
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart) (TOK_TABLESPLITSAMPLE 0.25))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key)) (TOK_SELEXPR (TOK_TABLE_OR_COL value)) (TOK_SELEXPR (TOK_TABLE_OR_COL BLOCK__OFFSET__INSIDE__FILE)))))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: srcpart
          Select Operator
            expressions:
                  expr: key
                  type: string
                  expr: value
                  type: string
                  expr: BLOCK__OFFSET__INSIDE__FILE
                  type: bigint
            outputColumnNames: _col0, _col1, _col2


PREHOOK: query: select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart TABLESAMPLE (0.25 PERCENT)
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
POSTHOOK: query: select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart TABLESAMPLE (0.25 PERCENT)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
238	val_238	0
86	val_86	12
238	val_238	0
86	val_86	12
238	val_238	0
86	val_86	12
238	val_238	0
86	val_86	12
PREHOOK: query: -- non deterministic
explain select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart where ds="2008-04-09" AND rand() > 1
PREHOOK: type: QUERY
POSTHOOK: query: -- non deterministic
explain select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart where ds="2008-04-09" AND rand() > 1
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME srcpart))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key)) (TOK_SELEXPR (TOK_TABLE_OR_COL value)) (TOK_SELEXPR (TOK_TABLE_OR_COL BLOCK__OFFSET__INSIDE__FILE))) (TOK_WHERE (AND (= (TOK_TABLE_OR_COL ds) "2008-04-09") (> (TOK_FUNCTION rand) 1)))))

STAGE DEPENDENCIES:
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: srcpart
          Filter Operator
            predicate:
                expr: (rand() > 1)
                type: boolean
            Select Operator
              expressions:
                    expr: key
                    type: string
                    expr: value
                    type: string
                    expr: BLOCK__OFFSET__INSIDE__FILE
                    type: bigint
              outputColumnNames: _col0, _col1, _col2


PREHOOK: query: select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart where ds="2008-04-09" AND rand() > 1
PREHOOK: type: QUERY
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
POSTHOOK: query: select key, value, BLOCK__OFFSET__INSIDE__FILE from srcpart where ds="2008-04-09" AND rand() > 1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
#### A masked pattern was here ####
PREHOOK: query: explain select key from src order by key desc limit 10
PREHOOK: type: QUERY
POSTHOOK: query: explain select key from src order by key desc limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEDESC (TOK_TABLE_OR_COL key))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src
          Select Operator
            expressions:
                  expr: key
                  type: string
            outputColumnNames: _col0
            Reduce Output Operator
              key expressions:
                    expr: _col0
                    type: string
              sort order: -
              tag: -1
              value expressions:
                    expr: _col0
                    type: string
              Extract
                Limit
                  File Output Operator
                    compressed: false
                    GlobalTableId: 0
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-1
    Fetch Operator
      limit: 10


PREHOOK: query: select key, value from src order by key desc limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key, value from src order by key desc limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
98	val_98
98	val_98
97	val_97
97	val_97
96	val_96
95	val_95
95	val_95
92	val_92
90	val_90
90	val_90
PREHOOK: query: explain select key, value from src order by key desc limit 10
PREHOOK: type: QUERY
POSTHOOK: query: explain select key, value from src order by key desc limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL key)) (TOK_SELEXPR (TOK_TABLE_OR_COL value))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEDESC (TOK_TABLE_OR_COL key))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage
  Stage-1 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src
          Select Operator
            expressions:
                  expr: key
                  type: string
                  expr: value
                  type: string
            outputColumnNames: _col0, _col1
            Reduce Output Operator
              key expressions:
                    expr: _col0
                    type: string
              sort order: -
              tag: -1
              value expressions:
                    expr: _col0
                    type: string
                    expr: _col1
                    type: string
              Extract
                Limit
                  File Output Operator
                    compressed: false
                    GlobalTableId: 0
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-1
    Fetch Operator
      limit: 10


PREHOOK: query: select key, value from src order by key desc limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select key, value from src order by key desc limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
98	val_98
98	val_98
97	val_97
97	val_97
96	val_96
95	val_95
95	val_95
92	val_92
90	val_90
90	val_90
PREHOOK: query: explain select src.key from src join src src2 on src.key=src2.key where src2.key < 10 order by key
PREHOOK: type: QUERY
POSTHOOK: query: explain select src.key from src join src src2 on src.key=src2.key where src2.key < 10 order by key
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME src)) (TOK_TABREF (TOK_TABNAME src) src2) (= (. (TOK_TABLE_OR_COL src) key) (. (TOK_TABLE_OR_COL src2) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (. (TOK_TABLE_OR_COL src) key))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL src2) key) 10)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL key)))))

STAGE DEPENDENCIES:
  Stage-0 is a root stage
  Stage-1 is a root stage
  Stage-2 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: src2
          Filter Operator
            predicate:
                expr: (key < 10.0)
                type: boolean
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: string
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: string
              tag: 1
              value expressions:
                    expr: key
                    type: string
              Join Operator
                condition map:
                     Inner Join 0 to 1
                condition expressions:
                  0 {VALUE._col0}
                  1 {VALUE._col0}
                handleSkewJoin: false
                outputColumnNames: _col0, _col4
                Select Operator
                  expressions:
                        expr: _col0
                        type: string
                  outputColumnNames: _col0
                  Reduce Output Operator
                    key expressions:
                          expr: _col0
                          type: string
                    sort order: +
                    tag: -1
                    value expressions:
                          expr: _col0
                          type: string
                    Extract
                      File Output Operator
                        compressed: false
                        GlobalTableId: 0
                        table:
                            input format: org.apache.hadoop.mapred.TextInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-1
    Fetch Operator
      limit: -1
      Processor Tree:
        TableScan
          alias: src
          Filter Operator
            predicate:
                expr: (key < 10.0)
                type: boolean
            Reduce Output Operator
              key expressions:
                    expr: key
                    type: string
              sort order: +
              Map-reduce partition columns:
                    expr: key
                    type: string
              tag: 0
              value expressions:
                    expr: key
                    type: string
              Join Operator
                condition map:
                     Inner Join 0 to 1
                condition expressions:
                  0 {VALUE._col0}
                  1 {VALUE._col0}
                handleSkewJoin: false
                outputColumnNames: _col0, _col4
                Select Operator
                  expressions:
                        expr: _col0
                        type: string
                  outputColumnNames: _col0
                  Reduce Output Operator
                    key expressions:
                          expr: _col0
                          type: string
                    sort order: +
                    tag: -1
                    value expressions:
                          expr: _col0
                          type: string
                    Extract
                      File Output Operator
                        compressed: false
                        GlobalTableId: 0
                        table:
                            input format: org.apache.hadoop.mapred.TextInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-2
    Fetch Operator
      limit: -1


PREHOOK: query: select src.key from src join src src2 on src.key=src2.key where src2.key < 10 order by key
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select src.key from src join src src2 on src.key=src2.key where src2.key < 10 order by key
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
0
0
0
0
0
0
0
0
0
2
4
5
5
5
5
5
5
5
5
5
8
9
PREHOOK: query: explain select * from src src1 join src src2 on src1.key=src2.key order by src1.key desc limit 10
PREHOOK: type: QUERY
POSTHOOK: query: explain select * from src src1 join src src2 on src1.key=src2.key order by src1.key desc limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME src) src1) (TOK_TABREF (TOK_TABNAME src) src2) (= (. (TOK_TABLE_OR_COL src1) key) (. (TOK_TABLE_OR_COL src2) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEDESC (. (TOK_TABLE_OR_COL src1) key))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage
  Stage-1 is a root stage
  Stage-2 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src2
          Reduce Output Operator
            key expressions:
                  expr: key
                  type: string
            sort order: +
            Map-reduce partition columns:
                  expr: key
                  type: string
            tag: 1
            value expressions:
                  expr: key
                  type: string
                  expr: value
                  type: string
            Join Operator
              condition map:
                   Inner Join 0 to 1
              condition expressions:
                0 {VALUE._col0} {VALUE._col1}
                1 {VALUE._col0} {VALUE._col1}
              handleSkewJoin: false
              outputColumnNames: _col0, _col1, _col4, _col5
              Select Operator
                expressions:
                      expr: _col0
                      type: string
                      expr: _col1
                      type: string
                      expr: _col4
                      type: string
                      expr: _col5
                      type: string
                outputColumnNames: _col0, _col1, _col2, _col3
                Reduce Output Operator
                  key expressions:
                        expr: _col0
                        type: string
                  sort order: -
                  tag: -1
                  value expressions:
                        expr: _col0
                        type: string
                        expr: _col1
                        type: string
                        expr: _col2
                        type: string
                        expr: _col3
                        type: string
                  Extract
                    Limit
                      File Output Operator
                        compressed: false
                        GlobalTableId: 0
                        table:
                            input format: org.apache.hadoop.mapred.TextInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-1
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src1
          Reduce Output Operator
            key expressions:
                  expr: key
                  type: string
            sort order: +
            Map-reduce partition columns:
                  expr: key
                  type: string
            tag: 0
            value expressions:
                  expr: key
                  type: string
                  expr: value
                  type: string
            Join Operator
              condition map:
                   Inner Join 0 to 1
              condition expressions:
                0 {VALUE._col0} {VALUE._col1}
                1 {VALUE._col0} {VALUE._col1}
              handleSkewJoin: false
              outputColumnNames: _col0, _col1, _col4, _col5
              Select Operator
                expressions:
                      expr: _col0
                      type: string
                      expr: _col1
                      type: string
                      expr: _col4
                      type: string
                      expr: _col5
                      type: string
                outputColumnNames: _col0, _col1, _col2, _col3
                Reduce Output Operator
                  key expressions:
                        expr: _col0
                        type: string
                  sort order: -
                  tag: -1
                  value expressions:
                        expr: _col0
                        type: string
                        expr: _col1
                        type: string
                        expr: _col2
                        type: string
                        expr: _col3
                        type: string
                  Extract
                    Limit
                      File Output Operator
                        compressed: false
                        GlobalTableId: 0
                        table:
                            input format: org.apache.hadoop.mapred.TextInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-2
    Fetch Operator
      limit: 10


PREHOOK: query: select * from src src1 join src src2 on src1.key=src2.key order by src1.key desc limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select * from src src1 join src src2 on src1.key=src2.key order by src1.key desc limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
98	val_98	98	val_98
98	val_98	98	val_98
98	val_98	98	val_98
98	val_98	98	val_98
97	val_97	97	val_97
97	val_97	97	val_97
97	val_97	97	val_97
97	val_97	97	val_97
96	val_96	96	val_96
95	val_95	95	val_95
PREHOOK: query: explain select sum(cast (src1.key as int)) as keysum from src src1 join src src2 on src1.key=src2.key group by src1.key order by keysum desc limit 10
PREHOOK: type: QUERY
POSTHOOK: query: explain select sum(cast (src1.key as int)) as keysum from src src1 join src src2 on src1.key=src2.key group by src1.key order by keysum desc limit 10
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF (TOK_TABNAME src) src1) (TOK_TABREF (TOK_TABNAME src) src2) (= (. (TOK_TABLE_OR_COL src1) key) (. (TOK_TABLE_OR_COL src2) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION sum (TOK_FUNCTION TOK_INT (. (TOK_TABLE_OR_COL src1) key))) keysum)) (TOK_GROUPBY (. (TOK_TABLE_OR_COL src1) key)) (TOK_ORDERBY (TOK_TABSORTCOLNAMEDESC (TOK_TABLE_OR_COL keysum))) (TOK_LIMIT 10)))

STAGE DEPENDENCIES:
  Stage-0 is a root stage
  Stage-1 is a root stage
  Stage-2 is a root stage

STAGE PLANS:
  Stage: Stage-0
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src2
          Reduce Output Operator
            key expressions:
                  expr: key
                  type: string
            sort order: +
            Map-reduce partition columns:
                  expr: key
                  type: string
            tag: 1
            Join Operator
              condition map:
                   Inner Join 0 to 1
              condition expressions:
                0 {VALUE._col0}
                1 
              handleSkewJoin: false
              outputColumnNames: _col0
              Select Operator
                expressions:
                      expr: _col0
                      type: string
                outputColumnNames: _col0
                Group By Operator
                  aggregations:
                        expr: sum(UDFToInteger(_col0))
                  bucketGroup: false
                  keys:
                        expr: _col0
                        type: string
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Reduce Output Operator
                    key expressions:
                          expr: _col0
                          type: string
                    sort order: +
                    Map-reduce partition columns:
                          expr: _col0
                          type: string
                    tag: -1
                    value expressions:
                          expr: _col1
                          type: bigint
                    Group By Operator
                      aggregations:
                            expr: sum(VALUE._col0)
                      bucketGroup: false
                      keys:
                            expr: KEY._col0
                            type: string
                      mode: mergepartial
                      outputColumnNames: _col0, _col1
                      Select Operator
                        expressions:
                              expr: _col1
                              type: bigint
                        outputColumnNames: _col0
                        Reduce Output Operator
                          key expressions:
                                expr: _col0
                                type: bigint
                          sort order: -
                          tag: -1
                          value expressions:
                                expr: _col0
                                type: bigint
                          Extract
                            Limit
                              File Output Operator
                                compressed: false
                                GlobalTableId: 0
                                table:
                                    input format: org.apache.hadoop.mapred.TextInputFormat
                                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-1
    Fetch Operator
      limit: 10
      Processor Tree:
        TableScan
          alias: src1
          Reduce Output Operator
            key expressions:
                  expr: key
                  type: string
            sort order: +
            Map-reduce partition columns:
                  expr: key
                  type: string
            tag: 0
            value expressions:
                  expr: key
                  type: string
            Join Operator
              condition map:
                   Inner Join 0 to 1
              condition expressions:
                0 {VALUE._col0}
                1 
              handleSkewJoin: false
              outputColumnNames: _col0
              Select Operator
                expressions:
                      expr: _col0
                      type: string
                outputColumnNames: _col0
                Group By Operator
                  aggregations:
                        expr: sum(UDFToInteger(_col0))
                  bucketGroup: false
                  keys:
                        expr: _col0
                        type: string
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Reduce Output Operator
                    key expressions:
                          expr: _col0
                          type: string
                    sort order: +
                    Map-reduce partition columns:
                          expr: _col0
                          type: string
                    tag: -1
                    value expressions:
                          expr: _col1
                          type: bigint
                    Group By Operator
                      aggregations:
                            expr: sum(VALUE._col0)
                      bucketGroup: false
                      keys:
                            expr: KEY._col0
                            type: string
                      mode: mergepartial
                      outputColumnNames: _col0, _col1
                      Select Operator
                        expressions:
                              expr: _col1
                              type: bigint
                        outputColumnNames: _col0
                        Reduce Output Operator
                          key expressions:
                                expr: _col0
                                type: bigint
                          sort order: -
                          tag: -1
                          value expressions:
                                expr: _col0
                                type: bigint
                          Extract
                            Limit
                              File Output Operator
                                compressed: false
                                GlobalTableId: 0
                                table:
                                    input format: org.apache.hadoop.mapred.TextInputFormat
                                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-2
    Fetch Operator
      limit: 10


PREHOOK: query: select sum(cast (src1.key as int)) as keysum from src src1 join src src2 on src1.key=src2.key group by src1.key order by keysum desc limit 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: select sum(cast (src1.key as int)) as keysum from src src1 join src src2 on src1.key=src2.key group by src1.key order by keysum desc limit 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
11725
10025
8700
7824
7488
6496
5750
4482
4432
4320
