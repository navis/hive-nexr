PREHOOK: query: explain
SELECT value from (
  select explode(array(key, value)) as (value) from (
    select * FROM src WHERE key > 400
  ) A
) B WHERE value < 450
PREHOOK: type: QUERY
POSTHOOK: query: explain
SELECT value from (
  select explode(array(key, value)) as (value) from (
    select * FROM src WHERE key > 400
  ) A
) B WHERE value < 450
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME src))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (> (TOK_TABLE_OR_COL key) 400)))) A)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION explode (TOK_FUNCTION array (TOK_TABLE_OR_COL key) (TOK_TABLE_OR_COL value))) value)))) B)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_TABLE_OR_COL value))) (TOK_WHERE (< (TOK_TABLE_OR_COL value) 450))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        b:a:src 
          TableScan
            alias: src
            Filter Operator
              predicate:
                  expr: (key > 400.0)
                  type: boolean
              Select Operator
                expressions:
                      expr: array(key,value)
                      type: array<string>
                outputColumnNames: _col0
                UDTF Operator
                  function name: explode
                  Filter Operator
                    predicate:
                        expr: (col < 450.0)
                        type: boolean
                    Select Operator
                      expressions:
                            expr: col
                            type: string
                      outputColumnNames: _col0
                      File Output Operator
                        compressed: false
                        GlobalTableId: 0
                        table:
                            input format: org.apache.hadoop.mapred.TextInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1

PREHOOK: query: SELECT value from (
  select explode(array(key, value)) as (value) from (
    select * FROM src WHERE key > 400
  ) A
) B WHERE value < 450
PREHOOK: type: QUERY
PREHOOK: Input: default@src
#### A masked pattern was here ####
POSTHOOK: query: SELECT value from (
  select explode(array(key, value)) as (value) from (
    select * FROM src WHERE key > 400
  ) A
) B WHERE value < 450
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
#### A masked pattern was here ####
409
401
406
429
403
417
430
446
413
417
439
438
427
437
430
404
411
431
418
404
436
409
413
419
435
401
402
430
449
401
438
432
403
406
409
406
401
424
431
431
424
438
414
439
417
444
429
443
406
401
421
407
448
414
403
